<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>å°ˆæ¡ˆ:åˆ©ç”¨ Discord Bot ç›£æ§ Minecraft ä¼ºæœå™¨ç‹€æ…‹</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
    <main class="blog-post">
        <section id="header">
            <h3><a style="color: rgb(0, 69, 134);" target="_blank">è¬æ–‡æ· | Hsieh Wen Chieh</a></h3>
        </section>
        <div class="flex-section">
            <section id="about">
                <h1>å°ˆæ¡ˆ:åˆ©ç”¨ Discord Bot ç›£æ§ Minecraft ä¼ºæœå™¨ç‹€æ…‹</h1>
                <h3>å°ˆæ¡ˆç°¡ä»‹</h3>
                <p>ç‚ºäº†æ›´æ–¹ä¾¿ç›£æ§è‡ªæ¶çš„ Minecraft ä¼ºæœå™¨ç‹€æ…‹ï¼Œæˆ‘è¨­è¨ˆäº†ä¸€å€‹ Discord Botï¼Œèƒ½å¤ å®šæ™‚è‡ªå‹•å›å ±ä¼ºæœå™¨çš„å»¶é²èˆ‡åœ¨ç·šäººæ•¸ã€‚é€™å€‹æ©Ÿå™¨äººéƒ¨ç½²æ–¼ Ubuntu Server è™›æ“¬æ©Ÿå™¨ä¸­ï¼Œèˆ‡ Discord é »é“ä¸²æ¥ï¼Œå¯¦ç¾ä¼ºæœå™¨å³æ™‚ç‹€æ…‹é€šçŸ¥ï¼Œä¸¦æ”¯æ´æŒ‡ä»¤æŸ¥è©¢ï¼Œæå‡äº†ç®¡ç†æ•ˆç‡èˆ‡è³‡è¨Šé€æ˜åº¦ã€‚</p>
                <h3>åŠŸèƒ½èªªæ˜</h3>
                <p>â€¢ !status æŒ‡ä»¤ï¼šæ‰‹å‹•æŸ¥è©¢ä¼ºæœå™¨ç‹€æ…‹</p>
                <p>â€¢ è‡ªå‹•é€šçŸ¥ï¼šæ¯ 5 åˆ†é˜æ¨æ’­ä¼ºæœå™¨åœ¨ç·šäººæ•¸èˆ‡å»¶é²è‡³æŒ‡å®šé »é“</p>
                <p>â€¢ éŒ¯èª¤è™•ç†ï¼šè‹¥ä¼ºæœå™¨é—œé–‰æˆ–ç„¡æ³•æŸ¥è©¢ï¼Œæœƒå›å‚³éŒ¯èª¤é€šçŸ¥</p>
                <h3>æŠ€è¡“ç´°ç¯€</h3>
                <p>â€¢ ä¸»è¦å¥—ä»¶ï¼š</p>
                    <p>â€¢ discord.pyï¼šèˆ‡ Discord API æºé€š</p>
                    <p>â€¢ mcstatusï¼šæŸ¥è©¢ Minecraft Java ä¼ºæœå™¨ç‹€æ…‹</p>
                    <p>â€¢ apschedulerï¼šå®šæ™‚ä»»å‹™æ’ç¨‹</p>
                <p>â€¢ åŸ·è¡Œæ¶æ§‹ï¼š</p>
                    <p>â€¢ é€é systemd æœå‹™å¸¸é§å•Ÿå‹•</p>
                    <p>â€¢ Discord bot å¯¦ä¾‹èˆ‡äº‹ä»¶å¾ªç’°ç”± asyncio ç®¡ç†</p>
                    <p>â€¢ å®šæ™‚ä»»å‹™è‡ªå‹•æŸ¥è©¢ä¼ºæœå™¨ä¸¦å›å ±è¨Šæ¯è‡³ Discord é »é“</p>
                <h3>å¯¦éš›é‹ä½œç•«é¢</h3>
                <img src="images/dc-mc-run.jpg" alt="æˆ‘çš„ç…§ç‰‡" width="600" />
                <p>"åœ¨ä¼ºæœå™¨ç„¡ä½œå‹•æ™‚é¡¯ç¤ºç´…è‰²ï¼Œåä¹‹å‰‡ç‚ºç¶ è‰²ï¼Œå¯ä½¿ç”¨!statuså‘¼å«æ©Ÿå™¨äºº"</p>
                <h3>åŸå§‹ç¢¼èˆ‡éƒ¨ç½²æ•™å­¸</h3>
                <a href="https://github.com/Xie-qwp1234/Discord-Port-Monitor-Bot">Github</a>
                <h5>bot.py</h5>
                <pre><code class="language-python">
                import os
                import asyncio
                import discord
                from discord.ext import commands
                from dotenv import load_dotenv
                from mcstatus import JavaServer
                from apscheduler.schedulers.asyncio import AsyncIOScheduler

                load_dotenv()

                DISCORD_TOKEN = os.getenv("DISCORD_TOKEN")
                CHANNEL_ID = os.getenv("CHANNEL_ID")
                MC_ADDRESS = os.getenv("MC_ADDRESS")

                if not all([DISCORD_TOKEN, CHANNEL_ID, MC_ADDRESS]):
                    print("âš ï¸ è«‹ç¢ºèª .env æª”æ¡ˆçš„ DISCORD_TOKENã€CHANNEL_IDã€MC_ADDRESS éƒ½æœ‰æ­£ç¢ºè¨­å®šï¼")
                    exit(1)

                intents = discord.Intents.default()
                intents.message_content = True

                bot = commands.Bot(command_prefix="!", intents=intents)

                async def send_status():
                    channel = bot.get_channel(int(CHANNEL_ID))
                    if not channel:
                        print(f"âš ï¸ æ‰¾ä¸åˆ°é »é“ ID {CHANNEL_ID}")
                        return

                    try:
                        server = JavaServer.lookup(MC_ADDRESS)
                        status = await asyncio.get_event_loop().run_in_executor(None, server.status)

                        embed = discord.Embed(title="ğŸŸ¢ Minecraft Server Status", color=0x00ff00)
                        embed.add_field(name="å»¶é²", value=f"{status.latency:.1f} ms", inline=True)
                        embed.add_field(name="äººæ•¸", value=f"{status.players.online}/{status.players.max}", inline=True)
                    except Exception as e:
                        embed = discord.Embed(title="ğŸ”´ Minecraft Server Status", description=str(e), color=0xff0000)

                    await channel.send(embed=embed)

                @bot.event
                async def on_ready():
                    print(f"âœ… Discord Bot å•Ÿå‹•æˆåŠŸï¼ç™»å…¥å¸³è™Ÿï¼š{bot.user}")
                    scheduler = AsyncIOScheduler()
                    scheduler.add_job(send_status, "interval", minutes=5)
                    scheduler.start()

                @bot.command(name="status")
                async def manual_status(ctx):
                    try:
                        server = JavaServer.lookup(MC_ADDRESS)
                        status = server.status()

                        embed = discord.Embed(title="ğŸŸ¢ Minecraft Server Status", color=0x00ff00)
                        embed.add_field(name="å»¶é²", value=f"{status.latency:.1f} ms", inline=True)
                        embed.add_field(name="äººæ•¸", value=f"{status.players.online}/{status.players.max}", inline=True)
                    except Exception as e:
                        embed = discord.Embed(title="ğŸ”´ Minecraft Server Status", description=str(e), color=0xff0000)

                    await ctx.send(embed=embed)

                if __name__ == "__main__":
                    bot.run(DISCORD_TOKEN)

                </code></pre>

                <h5>mcstatusbot.service</h5>
                <pre><code class="language-python">
                [Unit]
                Description=Minecraft Server Status Discord Bot
                After=network.target

                [Service]
                Type=simple
                User=root
                WorkingDirectory=/root/mc-status-bot
                ExecStart=/root/mc-status-bot/venv/bin/python /root/mc-status-bot/bot.py
                Restart=always
                RestartSec=10

                [Install]
                WantedBy=multi-user.target


                </code></pre>

                <h5>env.env</h5>
                <pre><code class="language-python">
                DISCORD_TOKEN=(ä½ çš„æ©Ÿå™¨äººTOKEN)
                CHANNEL_ID=(æƒ³ç™¼æ–‡çš„é »é“ID)
                MC_ADDRESS=(ä½ æƒ³ç›£æ§çš„IP)

                </code></pre>
                <h3>å¿ƒå¾—</h3>
                <p>é€™å€‹å°ˆæ¡ˆè®“æˆ‘æ›´æ·±å…¥æŒæ¡äº† Python èˆ‡ Discord Bot çš„å¯¦ä½œæµç¨‹ï¼Œä¸¦å­¸ç¿’å¦‚ä½•åœ¨ Linux ç’°å¢ƒä¸­éƒ¨ç½²å¸¸é§æœå‹™ã€‚ä¹Ÿå¯¦éš›é‹ç”¨ mcstatus èˆ‡ apscheduler å¯¦ç¾ Minecraft ç‹€æ…‹æŸ¥è©¢èˆ‡è‡ªå‹•æ¨æ’­ã€‚
                åœ¨éç¨‹ä¸­æˆ‘ä¹Ÿé‡åˆ°äº†ä¸€äº›æŒ‘æˆ°ï¼Œä¾‹å¦‚ .env çš„è®€å–å•é¡Œã€systemd æœå‹™æœªè‡ªå‹•å•Ÿå‹•ã€Bot ç„¡æ³•é€£ç·šçš„æ’æŸ¥ç­‰ï¼Œä½†ä¹Ÿå› æ­¤å­¸æœƒäº†æ›´å¤šé—œæ–¼ Linux ç®¡ç†èˆ‡ Debug çš„æŠ€å·§ã€‚</p>
                </div>
            </section>


    <p><a href="index.html">â† è¿”å›é¦–é </a></p>
</main>

  <footer>
    <p>ğ– ¿ä¸å…¬é–‹ &emsp; â˜(+886)ä¸å…¬é–‹ &emsp; ğŸ–‚109st955160@gmail.com</p>
    <p>&copy; 2025 æ–‡æ·</p>
  </footer>
</body>
</html>
